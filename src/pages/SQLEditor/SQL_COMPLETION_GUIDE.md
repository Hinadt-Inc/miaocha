# SQL智能补全功能使用指南

## 功能概述

SQL编辑器现在配备了智能补全功能，可以根据当前的上下文提供精准的SQL语法建议，大大提高SQL编写效率。

## 主要特性

### 🎯 上下文感知补全
- **SELECT 子句**: 自动提供列名、函数和关键字建议
- **FROM 子句**: 提供数据库中的表名建议
- **WHERE 子句**: 提供列名和条件操作符建议
- **JOIN 子句**: 智能提供表名和连接条件建议

### 🗃️ 数据库结构集成
- 自动读取当前数据源的表结构
- 提供实际的表名和列名建议
- 包含列的类型信息和注释

### ⚡ 丰富的内置功能
- **SQL关键字**: 完整的SQL语法关键字支持
- **内置函数**: 40+常用SQL函数，包含聚合、字符串、日期、数学函数
- **SQL模板**: 15+常用SQL查询模板
- **窗口函数**: 支持现代SQL的窗口函数语法

## 使用方法

### 触发补全
1. **自动触发**: 输入字母时自动显示建议
2. **手动触发**: 按 `Ctrl + Space` 手动触发补全
3. **特殊字符**: 输入 `.`, `,`, `(`, ` ` 时自动触发相关补全

### 补全快捷键
- `↑/↓`: 选择建议项
- `Enter`: 确认选择
- `Tab`: 确认选择并跳转到下一个编辑点
- `Esc`: 关闭补全面板

### 模板参数
使用模板时，可以通过 `Tab` 键在参数占位符之间跳转：
```sql
SELECT * FROM ${1:table_name} WHERE ${2:condition};
      ↑              ↑
    Tab键跳转      下一个参数
```

## 功能详解

### 智能上下文识别

#### SELECT 语句补全
```sql
SELECT |  ← 此处会提供：列名、函数、关键字
```

#### FROM 语句补全
```sql
FROM |  ← 此处会提供：数据库中的表名
```

#### JOIN 语句补全
```sql
LEFT JOIN |  ← 此处会提供：表名
```

#### WHERE 条件补全
```sql
WHERE |  ← 此处会提供：列名、操作符
```

### SQL函数分类

#### 聚合函数
- `COUNT()`, `SUM()`, `AVG()`, `MAX()`, `MIN()`
- `COUNT(DISTINCT column)`

#### 字符串函数
- `CONCAT()`, `SUBSTRING()`, `UPPER()`, `LOWER()`
- `TRIM()`, `LENGTH()`, `REPLACE()`

#### 日期函数
- `NOW()`, `DATE_FORMAT()`, `DATE_ADD()`, `DATEDIFF()`
- `YEAR()`, `MONTH()`, `DAY()`

#### 窗口函数
- `ROW_NUMBER()`, `RANK()`, `DENSE_RANK()`
- `LAG()`, `LEAD()`

### SQL模板类型

#### 基础查询
- 基础SELECT查询
- 带TOP的查询
- 条件查询
- 分页查询

#### 连接查询
- INNER JOIN
- LEFT JOIN
- 复杂多表连接

#### 高级查询
- 子查询 (EXISTS, IN)
- 条件分支 (CASE WHEN)
- 窗口函数查询

#### 数据操作
- INSERT (单条/批量)
- UPDATE
- DELETE

## 性能优化

### 补全建议限制
- 每次最多显示50个建议项
- 优先显示最相关的建议
- 自动过滤重复项

### 触发字符优化
```sql
table.column  ← 输入'.'时触发列名补全
FROM table,   ← 输入','时触发下一个表名补全
COUNT(        ← 输入'('时触发参数补全
```

## 最佳实践

### 1. 充分利用上下文
```sql
-- 好的做法：先写FROM，再写SELECT
FROM user_table
SELECT |  ← 这里会准确提供user_table的列名
```

### 2. 使用模板提高效率
- 选择"插入SQL模板"按钮
- 使用Tab键在参数间快速跳转
- 根据需要修改模板内容

### 3. 合理使用函数补全
```sql
-- 输入函数名的前几个字母
SEL|  ← 输入后按Ctrl+Space，选择SELECT
COU|  ← 选择COUNT()函数
```

### 4. 数据库连接检查
- 确保已选择正确的数据源
- 等待数据库结构加载完成
- 结构信息将用于表名和列名补全

## 故障排除

### 补全不工作
1. 检查数据源是否已连接
2. 等待数据库结构加载完成
3. 刷新页面重新初始化编辑器

### 建议不准确
1. 确认当前数据源选择正确
2. 检查SQL语法是否有明显错误
3. 手动触发补全 (Ctrl+Space)

### 性能问题
1. 大型数据库可能需要更长加载时间
2. 复杂SQL可能影响补全响应速度
3. 建议分段编写复杂查询

## 更新记录

### v2.0 - 智能补全系统
- ✅ 新增上下文感知的智能补全
- ✅ 集成数据库结构信息
- ✅ 扩展SQL函数库到40+个
- ✅ 新增15+个SQL模板
- ✅ 支持参数占位符跳转
- ✅ 优化补全性能和准确性

---

💡 **提示**: 多使用补全功能可以显著提高SQL编写效率，减少语法错误！
